function loadTable(){$.get("https://visionary-site.herokuapp.com/search/all",function(a){var e=a;data_table=$("#inventory").DataTable({data:e.data,columns:[{data:"shape"},{data:"carat"},{data:"color"},{data:"clarity"},{data:"lab"},{data:"fluorescence"},{data:"price"}]}),initialize_price_slider(e),initialize_carat_slider(e),dynamic_click_filters(e),set_default_shapes(defaultShapes),$.fn.dataTable.ext.search.push(filter_price,filter_carat,filter_shape,filter_lab),data_table.columns().iterator("column",function(a,e){$(data_table.column(e).header()).append('<span class="sort-icon"/>')}),$("#filters_content").foundation("toggle")})}function set_default_shapes(a){$(".shapeFilter").prop("checked",!1),shapesShown.clear();for(shape in a){var e=a[shape];$('input[value="'+e+'"]').prop("checked",!0),shapesShown.add(e)}}function dynamic_click_filters(a){var e=a.statistics,t=e.dataRanges,i=t.find(function(a){return"shape"===a.dataRangeName}),n=i.values,r=t.find(function(a){return"lab"===a.dataRangeName}),l=r.values,d=new Partitioner(n,3),s=new Partitioner(l,2),c=d.getIterator(),o=s.getIterator(),p=Math.max(d.getMaxPartitionSize(),s.getMaxPartitionSize()),u=$("#checkbox_dynamic"),h=create_checkbox_filter_headers();u.append(h);var _=6;for(row=0;row<p;row++){var f=0,v=$("<div></div>");for(v.addClass("row"),u.append(v),currentColumn=0;currentColumn<_;currentColumn++){if(currentColumn<3){var m=c.next();if(m){var b=create_checkbox_filter("shapeFilter",m);v.append(b),shapesShown.add(m)}else f+=2}if(3==currentColumn){var w=$("<div></div>");if(w.addClass("small-1 columns end"),f>0){var k="small-offset-"+f;w.addClass(k)}var S=$("<hr></hr>");S.addClass("vertical"),w.append(S),v.append(w),console.log("empty with pad:"+f)}if(currentColumn>3){var x=o.next();if(x){var g=create_checkbox_filter("labFilter",x);4==currentColumn&&g.addClass("small-offset-1"),v.append(g),labsShown.add(x)}}}}add_shapeFilter_click(),add_labFilter_click()}function create_checkbox_filter_headers(){var a=$("<div></div>");a.addClass("row");var e=$("<div></div>");e.addClass("small-1 columns");var t=create_checkbox_header("Shape");a.append(t);var i=create_checkbox_header("Lab");return i.addClass("small-offset-7 end"),a.append(i),a}function create_checkbox_header(a){var e=$("<div></div>");e.addClass("small-1 columns");var t=$("<h5></h5>");return t.prop("align","center"),t.addClass("underlined"),t.text(a),e.append(t),e}function add_shapeFilter_click(){$(".shapeFilter").click(function(){var a=$(this).is(":checked");a?shapesShown.add($(this).val()):shapesShown["delete"]($(this).val()),data_table.draw()})}function add_labFilter_click(){$(".labFilter").click(function(){var a=$(this).is(":checked");a?labsShown.add($(this).val()):labsShown["delete"]($(this).val()),data_table.draw()})}function initialize_price_slider(a){var e=a.statistics,t=e.dataRanges;priceRange=t.find(function(a){return"price"===a.dataRangeName});var i=priceRange.minValue,n=priceRange.maxValue;new Foundation.Slider($("#price_slider"),{start:i,end:n,initialStart:i,initialEnd:n})}function filter_price(a,e,t){var i=parseInt($("#price_min_input").val(),10),n=parseInt($("#price_max_input").val(),10),r=parseFloat(e[6])||0;return isNaN(i)&&isNaN(n)||isNaN(i)&&n>=r||r>=i&&isNaN(n)||r>=i&&n>=r?!0:!1}function initialize_carat_slider(a){var e=a.statistics,t=e.dataRanges,i=t.find(function(a){return"carat"===a.dataRangeName}),n=i.minValue,r=i.maxValue;new Foundation.Slider($("#carat_slider"),{start:n,end:r,initialStart:n,initialEnd:r,step:.01})}function filter_carat(a,e,t){var i=parseFloat($("#carat_min_input").val(),10),n=parseFloat($("#carat_max_input").val(),10),r=parseFloat(e[1])||0;return isNaN(i)&&isNaN(n)||isNaN(i)&&n>=r||r>=i&&isNaN(n)||r>=i&&n>=r?!0:!1}function create_checkbox_filter(a,e){var t=$("<div></div>");t.addClass("small-2 columns");var i=$("<label></label>"),n=$("<input></input>");return n.addClass(a),n.prop("type","checkbox"),n.prop("checked",!0),n.prop("value",e),i.append(n),i.append(e),t.append(i),t}function filter_shape(a,e,t){var i=e[0];return shapesShown.has(i)?!0:!1}function filter_lab(a,e,t){var i=e[4];return labsShown.has(i)?!0:!1}$(document).foundation();var data_table,priceRange,defaultShapes=["Round"],shapesShown=new Set,labsShown=new Set;$(document).ready(function(){loadTable()}),$(document).on("moved.zf.slider",function(){data_table.draw()});